<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="it">
<head>
<meta charset="ISO-8859-1">
<title>Permission manager</title>
<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<link
	href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap"
	rel="stylesheet">

<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

</head>
<body onload="loadUse(); loadDoc();">

	<p>User</p>
	<div id="demo1"></div>
	<div style="text-align: center;">
		Permessi:
		<form method="POST">
    		<select id="Select" onclick="formSubmit()">
			</select>	
		</form>
		<p id="resulted"></p>
	
</div>

	<script type="text/javascript">
	
		
		function loadUse() {
			const xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {

					var risposta = this.responseText;
					
					var obj = JSON.parse(risposta);
					
					//var obj2 = { "permessi": ["X"] }; 
					//obj.push(obj2);
					
					document.getElementById("demo1").innerHTML = "<strong>"
							+ obj.nome + "</strong>&nbsp;&nbsp;&nbsp;&nbsp;"
							+ obj.permessi;

				}

			};
			xhttp.open("GET", "/view/permissionManager/user.json", true);
			xhttp.send();
		}

		function loadDoc() {
			const xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					var risposta = this.responseText;
					var obj = JSON.parse(risposta)
					for (var i = 0; i < obj.length; i++) {
						var select = document.getElementById("Select");
						var option = document.createElement("option");
						option.text = obj[i].nome + " " + obj[i].descrizione ;
						option.value = obj[i].nome;
						select.add(option);
						
					}
				}
			};
			xhttp.open("GET", "/view/permissionManager/data.json", true);
			xhttp.send();
		}
		
		function formSubmit(){
			  var x = document.getElementById("Select").value;
			  document.getElementById("resulted").innerHTML = "Hai selezionato '" + x +"'";
		}
		
		
	</script>

</body>
</html>